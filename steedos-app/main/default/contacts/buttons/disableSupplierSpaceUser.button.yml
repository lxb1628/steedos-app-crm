label: 禁用供应商用户
'on': record_only_more
name: disableSupplierSpaceUser
todo: "module.exports = { \r\ndisableSupplierSpaceUser:function(object_name, record_id, fields){\r\n        text = '将禁用与此供应商关联的外部用户。 是否确定？';\r\n        swal({\r\n            title: \"禁用供应商账户\",\r\n            text: \"<div>\" + text + \"</div>\",\r\n            html: true,\r\n            showCancelButton: true,\r\n            confirmButtonText: t('YES'),\r\n            cancelButtonText: t('NO')\r\n        }, function (confirm) {\r\n            if(confirm){\r\n                $(\"body\").addClass(\"loading\");\r\n                var userSession = Creator.USER_CONTEXT;\r\n                var spaceId = userSession.spaceId;\r\n                var authToken = userSession.authToken ? userSession.authToken : userSession.user.authToken;\r\n                var url = \"/api/v4/contacts/\" + record_id + \"/disable_supplier_spaceuser\";\r\n                url = Steedos.absoluteUrl(url);\r\n                try {\r\n                    var authorization = \"Bearer \" + spaceId + \",\" + authToken;\r\n                    var headers = [{\r\n                        name: 'Content-Type',\r\n                        value: 'application/json'\r\n                    }, {\r\n                        name: 'Authorization',\r\n                        value: authorization\r\n                    }];\r\n                    $.ajax({\r\n                        type: \"get\",\r\n                        url: url,\r\n                        dataType: \"json\",\r\n                        contentType: 'application/json',\r\n                        beforeSend: function (XHR) {\r\n                            if (headers && headers.length) {\r\n                                return headers.forEach(function (header) {\r\n                                    return XHR.setRequestHeader(header.name, header.value);\r\n                                });\r\n                            }\r\n                        },\r\n                        success: function (data) {\r\n                            $(\"body\").removeClass(\"loading\");\r\n                            toastr.success(t('已禁用客户账户'));\r\n                        },\r\n                        error: function (XMLHttpRequest, textStatus, errorThrown) {\r\n                            console.error(XMLHttpRequest.responseJSON);\r\n                            $(\"body\").removeClass(\"loading\");\r\n                            if (XMLHttpRequest.responseJSON && XMLHttpRequest.responseJSON.error) {\r\n                                toastr.error(t(XMLHttpRequest.responseJSON.error.replace(/:/g, '：')))\r\n                            }\r\n                            else {\r\n                                toastr.error(XMLHttpRequest.responseJSON)\r\n                            }\r\n                        }\r\n                    });\r\n                } catch (err) {\r\n                    console.error(err);\r\n                    toastr.error(err);\r\n                    $(\"body\").removeClass(\"loading\");\r\n                }\r\n            }\r\n            sweetAlert.close();\r\n        })\r\n    },\r\ndisableSupplierSpaceUserVisible:function(object_name, record_id, record_permissions){\r\n        if(!Creator.isSpaceAdmin()){\r\n            return false\r\n        }\r\n        var record = Creator.odata.get(\"contacts\", record_id, \"account,user\", \"account($select=is_supplier)\");\r\n        if(record && record.user){\r\n            var spaceUser = Creator.odata.query(\"space_users\", {\r\n                $filter: \"(user eq '\".concat(record.user, \"')\"),\r\n                $select: \"is_supplier\"\r\n              }, true);\r\n            if(spaceUser[0].is_supplier){\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n }"
