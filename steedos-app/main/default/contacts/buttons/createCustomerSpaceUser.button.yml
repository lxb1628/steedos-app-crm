label: 创建客户用户
'on': record_only_more
name: createCustomerSpaceUser
todo: "module.exports = { \r\ncreateCustomerSpaceUser:function(){\r\n        var objectName = \"space_users\"\r\n\t\tvar object = Creator.getObject(objectName)\r\n\t\tvar collection_name = object.label\r\n\t\tSession.set(\"action_collection\", \"Creator.Collections.\"+objectName)\r\n\t\tSession.set(\"action_collection_name\", collection_name)\r\n\t\tSession.set(\"action_save_and_insert\", false)\r\n        Session.set(\"cmDoc\", Object.assign({is_customer: true, contact_id: this.record._id, profile: 'customer'}, this.record));\r\n        console.log(\"this.record\", Object.assign({is_customer: true}, this.record) );\r\n        Meteor.defer(function(){\r\n            $(\".creator-add\").click()\r\n        })\t\t\r\n    },\r\ncreateCustomerSpaceUserVisible:function(object_name, record_id, record_permissions){\r\n        if(!Creator.isSpaceAdmin()){\r\n            return false\r\n        }\r\n\r\n        var record = Creator.odata.get(\"contacts\", record_id, \"account,user\", \"account($select=is_customer)\");\r\n        if(record && record.account && record.account.is_customer && !record.user){\r\n            return true;\r\n        }\r\n    }\r\n }"
